Tasks:
  - [ ] Only generate new private key if it isn't present.
  - [ ] Don't report changed unless a new private key is used
  - [ ] Fix endpoint role loop
