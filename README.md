Tasks:
  - [x] Only generate new private key if it isn't present.
  - [x] Don't report changed unless a new private key is used
  - [x] Fix endpoint role loop
  - [ ] Refactor roles with better names
